<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>: Dependency Management with Gradle</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/gradle.css" id="theme" /><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-player.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-theme-gradle.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/highlight-theme.css" />
<script src="reveal.js/css/theme/asciinema-player.js"></script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-transition="zoom" data-transition-speed="fast" data-background-image="./images/title.png"><h1></h1><h2>Dependency Management with Gradle</h2><div class="preamble"><div class="paragraph"><p><h3>
Publishing and release strategies
<div style="font-size: 0.5em; padding-top:60px">
Cédric Champeau (@CedricChampeau) &amp;
Louis Jacomet (@ljacomet) - Gradle Inc.
</div>
</h3></p></div></div></section>
<section id="who-are-we"><h2>Who are we?</h2><div class="imageblock" style=""><img src="./images/who-s-who.png" alt="who s who" width="520" height="250" /></div>
<div class="paragraph"><p>Dependency management team</p></div></section>
<section id="agenda"><h2>Agenda</h2><div class="ulist"><ul><li><p>Publishing basics</p></li><li><p>Customizing publications</p></li><li><p>The Gradle component model</p></li><li><p>Published metadata</p></li><li><p>Versioning</p></li></ul></div></section>
<section><section id="publishing-basics" data-background-color="#01303a"><h2>Publishing Basics</h2></section><section id="publishing-building-blocks"><h2>Publishing building blocks</h2><div class="ulist"><ul><li><p>The plugins: <code>maven-publish</code> and <code>ivy-publish</code></p></li><li><p>The concept of a <em>publication</em></p></li><li><p>One or more target repositories</p></li></ul></div>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa fa-warning" title="Warning"></i></td><td class="content"><div class="paragraph"><p>This presentation does not cover the <em>legacy</em> publication system, deprecated in Gradle 6.0</p></div></td></tr></table></div></section><section id="basic-publishing-demo" data-background-color="#01303a"><h2>Basic publishing demo</h2></section><section id="plugin-and-basic-information"><h2>Plugin and basic information</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins {
    `java-library`
    `maven-publish`
}

group = "org.test"
version = "0.0.1"</code></pre></section><section id="adding-the-publication"><h2>Adding the publication</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">publishing {
    publications {
        create&lt;MavenPublication&gt;("main") {
            from(components["java"])
        }
    }
}</code></pre></section><section id="adding-the-repository"><h2>Adding the repository</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">publishing {
    repositories {
        maven {
            name = "artifactory"
            url = uri("http://localhost:8081/artifactory/example-repo-local")
        }
    }
}</code></pre>
<div class="paragraph"><p>Multiple repositories can be defined that way, in case you need to publish to more than one location.</p></div></section><section id="adding-a-local-test-repository"><h2>Adding a local test repository</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">maven {
    name = "testRepo"
    url = uri("$buildDir/repo")
}</code></pre>
<div class="paragraph"><p>This test repository can be useful to review the produced publication files, before uploading them to their final destination.</p></div></section><section id="publication-tasks"><h2>Publication tasks</h2><div class="paragraph"><p>The publication plugins will define a number of tasks based on the declared <em>publications</em> and <em>repositories</em>:</p></div>
<div class="ulist"><ul><li><p><code>publish&lt;Publication&gt;PublicationTo&lt;Repository&gt;Repository</code> to publish a <em>specific</em> publication to a <em>specific</em> repository</p></li><li><p><code>publishAllPublicationsTo&lt;Repository&gt;Repository</code> to publish <em>all</em> publications to a <em>specific</em> repository</p></li><li><p><code>publish</code> to publish <em>all</em> publications to <em>all</em> repositories</p></li></ul></div></section><section id="more-publication-tasks"><h2>More publication tasks</h2><div class="ulist"><ul><li><p><code>publishToMavenLocal</code> to publish <em>all maven</em> publications to the Maven local repository</p><div class="ulist"><ul><li><p>This is <em>not</em> executed when using <code>publish</code></p></li></ul></div></li><li><p><code>generate&lt;MetadataType&gt;FileFor&lt;Publication&gt;Publication</code> to generate the metadata file (Ivy, Maven or Gradle) for a <em>specific</em> publication.</p></li></ul></div></section><section id="signing-publications"><h2>Signing publications</h2><div class="ulist"><ul><li><p>Requires the <code>signing</code> plugin</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">signing {
    setRequired({ !version.toString().endsWith("-SNAPSHOT") })
    useGpgCmd()
    sign(publishing.publications["main"])
}</code></pre></section><section id="publication-result"><h2>Publication result</h2><div class="ulist"><ul><li><p>The <em>artifacts</em> of the selected component</p><div class="ulist"><ul><li><p>Usually the JAR file for a Java project</p></li></ul></div></li><li><p>The <em>metadata</em> of the selected component</p><div class="ulist"><ul><li><p>Maven or Ivy depending on the repository type</p></li><li><p>Gradle Module Metadata by default starting with Gradle 6.0</p></li></ul></div></li><li><p>Extra files</p><div class="ulist"><ul><li><p>Checksums: MD5, SHA1, SHA256, SHA512 (last two with Gradle 6.0)</p></li><li><p>Signatures if signing configured</p></li></ul></div></li></ul></div></section></section>
<section><section id="publishing-additional-artifacts" data-background-color="#01303a"><h2>Publishing additional artifacts</h2></section><section id="use-cases"><h2>Use cases</h2><div class="ulist"><ul><li><p>Publication of javadoc and sources JARs</p></li><li><p>Your project defines additional archives</p><div class="ulist"><ul><li><p>Test fixtures</p></li><li><p>Optional features</p></li></ul></div></li></ul></div>
<div class="paragraph"><p>In all the cases above, we want to publish not only the <em>added artifact</em> but also its relevant <em>metadata</em>.</p></div></section><section id="extra-artifacts-demo" data-background-color="#01303a"><h2>Extra artifacts demo</h2></section><section id="publishing-javadoc-and-sources"><h2>Publishing javadoc and sources</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">java {
    withJavadocJar()
    withSourcesJar()
}</code></pre>
<div class="ulist"><ul><li><p>Produces <em>and</em> attaches the JAR to the publication &#8230;&#8203;</p></li><li><p>As variants, with the right <em>variant attributes</em></p></li></ul></div></section><section id="using-test-fixtures"><h2>Using test fixtures</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins {
    `java-test-fixtures`
}
dependencies {
    testFixturesApi("org.assertj:assertj-core:3.13.2")
}</code></pre>
<div class="ulist"><ul><li><p>Gives you an extra source set: <code>testFixtures</code></p></li><li><p>Gives you configurations to declare dependencies: <code>testFixturesApi</code> and <code>testFixturesImplementation</code></p></li><li><p>Creates the necessary configurations for compiling, running and consuming the test fixtures</p></li></ul></div></section><section id="publishing-test-fixtures"><h2>Publishing test fixtures</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>All wired for you.
Nothing to do.</p></div></blockquote></div>
<div class="paragraph"><p>Details in later sections</p></div></section><section id="optional-features"><h2>Optional features</h2><div class="ulist"><ul><li><p>Additional features of your library, that may require:</p><div class="ulist"><ul><li><p>Additional dependencies</p></li><li><p>Additional artifact</p></li></ul></div></li><li><p>while still using a single project for development</p></li></ul></div>
<div class="paragraph"><p>Test fixtures are one use case for this concept</p></div></section><section id="optional-features-demo" data-background-color="#01303a"><h2>Optional features demo</h2></section><section id="optional-feature-declaration"><h2>Optional feature declaration</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">java {
    registerFeature("optionalFeature") {
        usingSourceSet(sourceSets["main"])
    }
}</code></pre>
<div class="ulist"><ul><li><p>Source set choice indicates whether optional aspect is bundled with the main JAR or as an additional artifact</p></li><li><p>Creates the configurations for dependency declarations and wires them properly</p></li></ul></div></section><section id="publishing-a-feature"><h2>Publishing a feature</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>All wired for you.
Nothing to do.</p></div></blockquote></div>
<div class="paragraph"><p>Details in later sections</p></div></section><section id="consuming-a-feature"><h2>Consuming a feature</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">implementation("org.test:publish-feature:0.0.1") {
    capabilities {
        requireCapability("org.test:publish-feature-optional-feature")
    }
}</code></pre>
<div class="ulist"><ul><li><p>Selection happens through the use of <em>capabilities</em></p></li></ul></div></section><section id="handling-mutually-exclusive-features"><h2>Handling mutually exclusive features</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">java {
    registerFeature("mysqlSupport") {
        usingSourceSet(sourceSets["main"])
        capability("org.gradle.demo", "producer-db-support", "1.0")
        capability("org.gradle.demo", "producer-mysql-support", "1.0")
    }
    registerFeature("postgresSupport") {
        usingSourceSet(sourceSets["main"])
        capability("org.gradle.demo", "producer-db-support", "1.0")
        capability("org.gradle.demo", "producer-postgres-support", "1.0")
    }
}</code></pre>
<div class="paragraph"><p>Since only one module can provide a given capability, sharing a capability forces consumer to chose only one capability provider.</p></div></section><section id="complete-documentation"><h2>Complete documentation</h2><div class="ulist"><ul><li><p><a href="https://docs.gradle.org/6.0-rc-1/userguide/java_testing.html#sec:java_test_fixtures">Test fixtures documentation</a></p></li><li><p><a href="https://docs.gradle.org/6.0-rc-1/userguide/feature_variants.html">Feature variants documentation</a></p></li></ul></div></section></section>
<section><section id="the-component-model" data-background-color="#01303a"><h2>The component model</h2></section><section id="the-component-model-2"><h2>The component model</h2><div class="imageblock" style=""><img src="./images/diag-321a71c26a819251361c60a258d0b4c8.png" alt="diag 321a71c26a819251361c60a258d0b4c8" width="1280" height="500" /></div></section><section id="java-component"><h2>Java component</h2><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">from(components["java"])</code></pre>
<div class="imageblock" style=""><img src="./images/diag-7d0e0a8ea5eb56b56ad8ed6412362902.png" alt="diag 7d0e0a8ea5eb56b56ad8ed6412362902" width="600" height="500" /></div></section><section id="the-component-model-3"><h2>The component model</h2><div class="paragraph"><p>Creates <em>safe boundaries</em> between projects</p></div>
<div class="paragraph"><p>Ground for the publication model</p></div>
<div class="ulist"><ul><li><p>Artifacts are attached to <em>configurations</em></p></li><li><p>which are exposed as <em>variants</em></p></li><li><p>which belong to a <em>component</em></p></li></ul></div></section><section id="sharing-task-outputs-between-projects"><div class="quoteblock"><blockquote>“How do I share the output of a task between subprojects?”</blockquote><div class="attribution">&#8212; Many Gradle users</div></div></section><section id="sharing-task-outputs"><h2>Sharing task outputs</h2><div class="ulist"><ul><li><p>Classic (but wrong) answer:</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">project(":subproject").tasks.getByName("someTask")</code></pre>
<div class="ulist"><ul><li><p>Unsafe</p></li><li><p>Poorly modeled</p></li></ul></div></section><section id="safe-cross-project-publications-demo" data-background-color="#01303a"><h2>Safe cross-project publications demo</h2></section><section id="cross-project-publications"><h2>Cross-project publications</h2><div class="ulist"><ul><li><p>Producer: create an <em>outgoing</em> configuration</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val instrumentedJars by configurations.creating {
    isCanBeConsumed = true
    isCanBeResolved = false
    // If you want this configuration to share the same dependencies,
    // otherwise omit this line
    extendsFrom(
            configurations["implementation"],
            configurations["runtimeOnly"])
}</code></pre></section><section id="cross-project-publications-2"><h2>Cross-project publications</h2><div class="ulist"><ul><li><p>Producer: attach the artifact to the outgoing configuration</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val instrumentedJar = tasks.register&lt;Jar&gt;("instrumentedJar") {
    archiveClassifier.set("instrumented")
}
instrumentedJars.outgoing.artifact(instrumentedJar)</code></pre></section><section id="cross-project-publications-3"><h2>Cross-project publications</h2><div class="ulist"><ul><li><p>Consumer: declare a <em>resolvable</em> configuration</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val instrumentedClasspath by configurations.creating {
    isCanBeConsumed = false
    isCanBeResolved = true
}</code></pre></section><section id="cross-project-publications-4"><h2>Cross-project publications</h2><div class="ulist"><ul><li><p>Consumer: declaring a dependency on the configuration</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    instrumentedClasspath(project(mapOf(
        "path" to ":producer",
        "configuration" to "instrumentedJars")))
}</code></pre></section><section id="cross-project-publications-model-improvement"><h2>Cross-project publications: model improvement</h2><div class="ulist"><ul><li><p>Let&#8217;s improve modeling on the producer side</p></li><li><p>Producer:</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins {
    `java-library`
    `instrumented-jars`
}</code></pre></section><section id="cross-project-publications-model-improvement-2"><h2>Cross-project publications: model improvement</h2><div class="ulist"><ul><li><p>Moved logic to <code>buildSrc</code></p></li><li><p>Declaration of <em>attributes</em></p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">private fun Project.createOutgoingConfiguration(): Configuration {
    val instrumentedJars by configurations.creating {
        isCanBeConsumed = true
        isCanBeResolved = false
        attributes {
            attribute(Category.CATEGORY_ATTRIBUTE, namedAttribute(Category.LIBRARY))
            attribute(Usage.USAGE_ATTRIBUTE, namedAttribute(Usage.JAVA_RUNTIME))
            attribute(Bundling.BUNDLING_ATTRIBUTE, namedAttribute(Bundling.EXTERNAL))
            attribute(TargetJvmVersion.TARGET_JVM_VERSION_ATTRIBUTE, JavaVersion.current().majorVersion.toInt())
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE, namedAttribute("instrumented-jar"))
        }
    }
    return instrumentedJars
}</code></pre></section><section id="cross-project-publications-model-improvement-3"><h2>Cross-project publications: model improvement</h2><div class="ulist"><ul><li><p>Consumer: may now use <em>regular</em> dependency declarations</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation(project(":producer"))
    testImplementation("junit:junit:4.12")
}</code></pre></section><section id="cross-project-publications-model-improvement-4"><h2>Cross-project publications: model improvement</h2><div class="ulist"><ul><li><p>Consumer: asks for a <em>different</em> variant for test runtime</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">configurations {
    testRuntimeClasspath {
        attributes {
            attribute(LibraryElements.LIBRARY_ELEMENTS_ATTRIBUTE,
                    objects.named(LibraryElements::class.java, "instrumented-jar"))
        }
    }
}</code></pre></section><section id="cross-project-publications-model-improvement-5"><h2>Cross-project publications: model improvement</h2><div class="ulist"><ul><li><p>Consumer: now compile classpath and test runtime classpath use different <em>variants</em></p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">&gt; Task :consumer:resolveInstrumentedClasses
[/producer/build/classes/java/main, junit-4.12.jar, hamcrest-core-1.3.jar]
[producer-instrumented.jar, junit-4.12.jar, hamcrest-core-1.3.jar]</code></pre></section><section id="enriching-existing-components"><h2>Enriching existing components</h2><div class="ulist"><ul><li><p>Producer can add variants to existing components</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">        val javaComponent = components.findByName("java") as AdhocComponentWithVariants
        javaComponent.addVariantsFromConfiguration(outgoing) {
            // dependencies for this variant are considered runtime dependencies
            mapToMavenScope("runtime")
            // and also optional dependencies, because we don't want them to leak
            mapToOptional()
        }</code></pre></section><section id="creating-adhoc-components"><h2>Creating adhoc components</h2><div class="ulist"><ul><li><p>Or producer can create a full adhoc component</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">// create an adhoc component
val adhocComponent = softwareComponentFactory.adhoc("myAdhocComponent")
// add it to the list of components that this project declares
components.add(adhocComponent)
// and register a variant for publication
adhocComponent.addVariantsFromConfiguration(outgoing) {
    mapToMavenScope("runtime")
}</code></pre></section><section id="deeper-control-of-publications" data-background-color="#01303a"><h2>Deeper control of publications</h2></section><section id="filtering-out-variants-for-publication"><h2>Filtering out variants for publication</h2><div class="ulist"><ul><li><p>Sometimes you don&#8217;t need to publish all variants for external consumption</p></li><li><p>Example: test fixtures can be used <em>between projects</em> but shouldn&#8217;t be available from external contributors</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">val javaComponent = components["java"] as AdhocComponentWithVariants
javaComponent.withVariantsFromConfiguration(
        configurations.testFixturesApiElements) {
   skip()
}</code></pre></section><section id="extra-publishing-plugins"><h2>Extra publishing plugins</h2><div class="ulist"><ul><li><p>Artifactory plugin</p><div class="ulist"><ul><li><p>Leverages the <code>maven-plugin</code></p></li><li><p>Adds "build information" when uploading to Artifactory</p></li></ul></div></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">plugins {
  id("com.jfrog.artifactory") version "4.10.0"
}</code></pre>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa fa-warning" title="Warning"></i></td><td class="content">No support for Gradle Module Metadata yet!</td></tr></table></div></section><section id="extra-publishing-plugins-2"><h2>Extra publishing plugins</h2><div class="ulist"><ul><li><p>Bintray plugin</p><div class="ulist"><ul><li><p>Leverages the artifactory plugin</p></li><li><p>Provides way to publish to JCenter</p></li><li><p>Provides way to synchronize to Maven Central (optional)</p></li></ul></div></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="">plugins {
  id("com.jfrog.bintray") version "1.8.4"
}</code></pre>
<div class="admonitionblock warning"><table><tr><td class="icon"><i class="fa fa-warning" title="Warning"></i></td><td class="content">No support for Gradle Module Metadata yet!</td></tr></table></div></section></section>
<section><section id="metadata" data-background-color="#01303a"><h2>Metadata</h2></section><section id="supported-metadata-formats"><h2>Supported metadata formats</h2><div class="ulist"><ul><li><p>Apache Maven™ POM file</p><div class="ulist"><ul><li><p>Only in Maven repositories</p></li></ul></div></li><li><p>Apache Ivy™ ivy.xml file</p><div class="ulist"><ul><li><p>Only in Ivy repositories</p></li></ul></div></li><li><p>Gradle Module Metadata file</p><div class="ulist"><ul><li><p>In both types of repositories <strong>in addition</strong> to one of the above</p></li><li><p>Used by Gradle 6 if available instead of the above</p></li><li><p>Carries information on <em>variants</em>, <em>dependency constraints</em>, <em>custom artifacts</em></p></li></ul></div></li></ul></div></section><section id="gradle-module-metadata"><h2>Gradle Module Metadata</h2><pre class="highlight listingblock"><code data-noescape="">junit-jupiter-api/
├── junit-jupiter-api-5.6.0.pom ('published-with-gradle-metadata' marker)
├── junit-jupiter-api-5.6.0.module
├── junit-jupiter-api-5.6.0.jar
├── junit-jupiter-api-5.6.0-javadoc.jar
├── junit-jupiter-api-5.6.0-sources.jar</code></pre>
<div class="ulist"><ul><li><p>Information in <code>module</code> missing in <code>pom</code> includes:</p><div class="ulist"><ul><li><p>Variants with the knowledge about <code>javadoc.jar</code> and <code>sources.jar</code></p></li><li><p>Constraint on other JUnit <code>5.6.0</code> modules to align versions</p></li></ul></div></li></ul></div></section><section id="published-variants-with-artifacts"><h2>Published variants with artifacts</h2><div class="paragraph"><p><em>junit-jupiter-api-5.6.0.module</em> (excerpt)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  { "name": "apiElements" ... },
  { "name": "runtimeElements" ... },
  { "name": "javadocElements",
    "attributes": {
      "org.gradle.category": "documentation",
      "org.gradle.docstype": "javadoc",
    },
    "files": [
      { "url": "junit-jupiter-api-5.6.0-javadoc.jar" ... }
    ]},
  { "name": "sourcesElements" ... },</code></pre>
<div class="paragraph"><p><em>build.gradle.kts</em> (consumer example)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">val javadoc by configurations.creating {
    attributes.attribute(CATEGORY_ATTRIBUTE, objects.named(DOCUMENTATION))
    attributes.attribute(DOCS_TYPE_ATTRIBUTE, objects.named(JAVADOC))
}
dependencies { javadoc("org.junit.jupiter:junit-jupiter-api:5.6.0") }
tasks.create("doSomethingWithJavadocs") { doLast { javadoc.files } }</code></pre></section><section id="published-platform-dependency"><h2>Published platform dependency</h2><div class="paragraph"><p><em>junit-jupiter-api-5.6.0.module</em> (excerpt)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  {
    "name": "apiElements",
    "attributes": { "org.gradle.category": "library", ... },
    "dependencies": [
      {
        "group": "org.junit",
        "module": "junit-bom",
        "version": { "requires": "5.6.0" },
        "attributes": { "org.gradle.category": "platform" },
      }
    ]
  },</code></pre></section><section id="published-platform-bom"><h2>Published platform (BOM)</h2><div class="paragraph"><p><em>junit-bom-5.6.0.module</em> (excerpt)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  {
    "name": "apiElements",
    "attributes": { "org.gradle.category": "platform", ... },
    "dependencyConstraints": [
      {
        "group": "org.junit.jupiter",
        "module": "junit-jupiter-engine",
        "version": { "requires": "5.6.0" }
      }
    ]
  },</code></pre>
<div class="paragraph"><p><em>build.gradle.kts</em> (consumer example)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("org.junit.jupiter:junit-jupiter-api:5.6.0")
    //                         ↑↑↑ brings in 'junit-bom:5.6.0'
    implementation("org.junit.jupiter:junit-jupiter-engine:5.5.2")
    //    ↑↑↑ thanks to 'junit-bom:5.6.0' it will align to 5.6.0
}</code></pre></section><section id="metadata-format-features"><h2>Metadata format features</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:55%" /><col style="width:15%" /><col style="width:15%" /><col style="width:15%" /></colgroup><thead><tr><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Gradle</th><th class="tableblock halign-left valign-top">POM</th><th class="tableblock halign-left valign-top">Ivy</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Dependency constraints</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X*</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Dependencies on platforms</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X*</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Rich version constraints</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td></tr></table>
<div class="paragraph"><p>* <code>&lt;dependencyManagement&gt;</code> blocks are added to poms</p></div></section><section id="metadata-format-features-2"><h2>Metadata format features</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:55%" /><col style="width:15%" /><col style="width:15%" /><col style="width:15%" /></colgroup><thead><tr><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Gradle</th><th class="tableblock halign-left valign-top">POM</th><th class="tableblock halign-left valign-top">Ivy</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Component capabilities</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Feature variants</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X**</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Custom components</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">✔</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X**</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td></tr></table>
<div class="paragraph"><p>** Artifacts have to be addressed directly by consumer (e.g. by classifier)</p></div></section><section id="metadata-with-custom-variants"><h2>Metadata with custom variants</h2><div class="paragraph"><p><em>guava-28.1.module</em> (how could it look like?)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  { "name": "jdk6ApiElements", "dependencies": [ ... ],
    "attributes": { "org.gradle.jvm.version": 6, ... },
    "files": [{ "url": "../28.1-android/guava-28.1-android.jar" }]
  },
  { "name": "jdk8ApiElements", "dependencies": [ ... ],
    "attributes": { "org.gradle.jvm.version": 8, ... },
    "files": [{ "url": "../28.1-jre/guava-28.1-jre.jar" }]
  },
  { "name": "jdk6RuntimeElements" ... },
  { "name": "jdk8RuntimeElements" ... },</code></pre>
<div class="paragraph"><p><em>build.gradle.kts</em> (consumer example)</p></div>
<pre class="highlight listingblock"><code data-noescape="">dependencies {
    implementation("com.google.guava:guava:28.1-jre")
}
java {
    // 6 or 7 gets 'android.jar', 8+ gets 'jre.jar', &lt;6 fails
    targetCompatibility = JavaVersion.VERSION_1_6
}</code></pre></section></section>
<section><section id="strategies-for-publication" data-background-color="#01303a"><h2>Strategies for publication</h2></section><section id="declared-vs-published"><h2>Declared vs published</h2><div class="ulist"><ul><li><p>Your build file declares a number of <em>versions</em></p><div class="ulist"><ul><li><p>e.g., <code>commons-lang3:3.3</code></p></li></ul></div></li><li><p>Not necessarily the resolved one:</p><div class="ulist"><ul><li><p>e.g., <code>commons-lang3:3.3 &#8594; 3.4 (conflict resolution)</code></p></li></ul></div></li></ul></div></section><section id="declared-vs-published-2"><h2>Declared vs published</h2><div class="ulist"><ul><li><p>What about dynamic dependencies?</p></li><li><p>e.g. <code>commons-lang3:3.+</code></p></li><li><p>Gradle lets you choose between two modes: declared or resolved versions</p><div class="ulist"><ul><li><p>defaults to the <em>declared versions</em></p></li></ul></div></li></ul></div></section><section id="declared-versions"><h2>Declared versions</h2><div class="ulist"><ul><li><p>Pros</p><div class="ulist"><ul><li><p>Effectively what you need</p></li><li><p>Maximum expressiveness thanks to rich versions</p></li></ul></div></li><li><p>Cons</p><div class="ulist"><ul><li><p>Requires diligence in what is declared</p></li><li><p>Result may be very different</p></li></ul></div></li></ul></div></section><section id="resolved-versions"><h2>Resolved versions</h2><div class="ulist"><ul><li><p>Pros</p><div class="ulist"><ul><li><p>What you resolve is what you get</p></li><li><p>Stable resolution for consumers (no dynamic)</p></li></ul></div></li><li><p>Cons</p><div class="ulist"><ul><li><p>Lossy mapping (ranges disappear, for example)</p></li><li><p>Maybe unintentional</p></li><li><p>Always approximate (what resolution to use?)</p></li><li><p>Maybe incorrect (e.g. substitutions)</p></li></ul></div></li></ul></div></section><section id="resolved-rich-versions"><h2>Resolved rich versions</h2><div class="ulist"><ul><li><p>Makes the mapping lossy for Gradle as well</p></li><li><p>flattens to <code>require</code> or <code>strictly</code></p><div class="ulist"><ul><li><p>if the declared version is strictly, the resolved is as well</p></li></ul></div></li></ul></div></section><section id="how-to"><h2>How to</h2><pre class="highlight listingblock"><code data-noescape="">publishing {
    publications {
        create&lt;MavenPublication&gt;("mavenJava") {
            versionMapping {
                usage("java-api") {
                    fromResolutionOf("runtimeClasspath")
                }
                usage("java-runtime") {
                    fromResolutionResult()
                }
            }
        }
    }
}</code></pre></section><section id="relationship-with-dependency-locking"><h2>Relationship with dependency locking</h2><div class="ulist"><ul><li><p>Locking guarantees same resolution result</p></li><li><p>But lock files are <em>unknown</em> to consumers</p></li><li><p>Using locking + resolved result makes sense</p></li></ul></div></section><section id="future-work-on-resolved-versions"><h2>Future work on resolved versions</h2><div class="ulist"><ul><li><p>More strategies</p><div class="ulist"><ul><li><p>still publish ranges, <em>prefer</em> the resolved version</p></li><li><p>fail if resolved version disagrees with declared version</p></li></ul></div></li></ul></div></section><section id="release-strategies" data-background-color="#01303a"><h2>Release strategies</h2></section><section id="gradle-is-agnostic"><h2>Gradle is agnostic</h2><div class="ulist"><ul><li><p>Version is <em>simply</em> a <code>project</code> property</p></li><li><p>Open as to <em>where</em> to publish</p></li></ul></div></section><section id="which-version-to-release"><h2>Which version to release?</h2><div class="ulist"><ul><li><p><code>-SNAPSHOT</code>, based on the Maven convention</p><div class="ulist"><ul><li><p><em>Changing</em> aspect is a problem for reproducibility</p></li></ul></div></li><li><p>Unique releases</p><div class="ulist"><ul><li><p>Keeping up with releases requires work / automation</p></li></ul></div></li></ul></div></section><section id="where-to-publish"><h2>Where to publish?</h2><div class="ulist"><ul><li><p>Maven local repository</p><div class="ulist"><ul><li><p>Convenient but not without issues</p></li><li><p>Consider using repository content filtering to limit its impact</p></li></ul></div></li><li><p>Repository (local or remote)</p><div class="ulist"><ul><li><p>Requires more infrastructure</p></li></ul></div></li></ul></div></section><section id="strategies"><h2>Strategies</h2><div class="ulist"><ul><li><p>Live with the <code>-SNAPSHOT</code> limitations</p></li><li><p>Use dynamic versions and locking for easier automated updates</p><div class="ulist"><ul><li><p>Add publication of resolved versions</p></li></ul></div></li></ul></div></section><section id="integrations"><h2>Integrations</h2><div class="ulist"><ul><li><p>During development, integration can use:</p><div class="ulist"><ul><li><p>Publication and releases</p></li><li><p>Composite builds</p></li><li><p>Source dependencies</p></li></ul></div></li></ul></div></section><section id="plugins-can-help"><h2>Plugins can help</h2><div class="ulist"><ul><li><p><code>nebula-release-plugin</code> supports multiple release types</p><div class="ulist"><ul><li><p>Integrates with Git</p></li><li><p>final, candidate, snapshots, unique snapshots, &#8230;&#8203;</p></li><li><p>Give it a try!</p></li></ul></div></li></ul></div></section><section id="multi-repository-development"><h2>Multi repository development</h2><div class="paragraph"><p>This is really where all these concepts come into play <em>inside</em> an organisation.</p></div>
<div class="paragraph"><p>Stay tuned for a future webinar on this, and how Gradle can help!</p></div></section></section>
<section><section id="conclusion" data-background-color="#01303a"><h2>Conclusion</h2></section><section id="publishing"><h2>Publishing</h2><div class="ulist"><ul><li><p>Switch to the <code>maven-publish</code> or <code>ivy-plugin</code></p></li><li><p>Supports publishing POM/Ivy + Gradle Module Metadata</p></li><li><p>Gradle Module Metadata &#8594; richest</p></li><li><p>Flexible support for custom components</p><div class="ulist"><ul><li><p>already used by 3rd party plugins (Kotlin Native, Android, &#8230;&#8203;)</p></li></ul></div></li></ul></div></section></section>
<section id="thank-you" data-background-image="./images/thank-you.png" data-background-size="cover"></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script><!-- this currently shows up at the wrong location in the final index.html which means the style font is not properly applied-->

<div class="footer">
</div></body></html>